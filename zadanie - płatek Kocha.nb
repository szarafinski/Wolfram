(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14587,        324]
NotebookOptionsPosition[     14265,        308]
NotebookOutlinePosition[     14612,        323]
CellTagsIndexPosition[     14569,        320]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Stw\[OAcute]rz", " ", "procedur\:0119", " ", "rysuj\:0105c\:0105", " ", 
      "p\[LSlash]atek", " ", "Kocha", " ", "do", " ", "N"}], "-", 
     RowBox[{"tego", " ", "pokolenia"}]}], ",", 
    RowBox[{
    "w", " ", "kt\[OAcute]rym", " ", "co", " ", "drugi", " ", "segment", " ", 
     "jest", " ", 
     RowBox[{"odwr\[OAcute]cony", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{
    "n", ",", "Snowflake", ",", "start", ",", "finish", ",", "doline"}], 
    "]"}], "\n", 
   RowBox[{
    RowBox[{"Snowflake", "[", 
     RowBox[{"n_Integer", "?", "NonNegative"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lista", " ", "=", " ", 
       RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#1", "/.", 
              RowBox[{
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{"start_", ",", "finish_"}], "}"}], "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"doline", "[", 
                RowBox[{"start", ",", "finish", ",", " ", "#2"}], "]"}]}]}], 
             ")"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}], "}"}], ",", 
           "lista"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"doline", "[", 
      RowBox[{"start_", ",", "finish_", ",", " ", "segment_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vec", ",", "Normal"}], "}"}], ",", 
       RowBox[{
        RowBox[{"vec", "=", 
         RowBox[{"finish", "-", "start"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"normal", "=", 
         RowBox[{
          RowBox[{"Reverse", "[", "vec", "]"}], " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], " ", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2.5", "]"}], "/", "8"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"$ModuleNumber", ",", "2"}], "]"}], "\[Equal]", " ", 
           "0"}], ",", " ", 
          RowBox[{"normal", "=", "normal"}], ",", " ", 
          RowBox[{"normal", " ", "=", "  ", 
           RowBox[{"-", "normal"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"znak", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "poni\:017cszy", " ", "fragment", " ", "odwraca", " ", "co", " ", 
           "drugie", " ", "pokolenie", " ", "spos\[OAcute]b", " ", 
           "malowania", " ", "lini"}], ",", " ", 
          RowBox[{
           RowBox[{
           "raz", " ", "g\[OAcute]ra", " ", "raz", " ", "d\[OAcute]\[LSlash]",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"segment", ",", "2"}], "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"znak", " ", "=", " ", "1"}], ",", 
              RowBox[{"znak", " ", "=", 
               RowBox[{"-", "1"}]}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"start", ",", 
             RowBox[{"start", "+", 
              RowBox[{"vec", "/", "3"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"start", "+", 
              RowBox[{"vec", "/", "3"}]}], ",", 
             RowBox[{"start", "+", 
              RowBox[{"vec", "/", "2"}], "+", 
              RowBox[{"normal", "*", "znak"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"start", "+", 
              RowBox[{"vec", "/", "2"}], "+", 
              RowBox[{"normal", "*", "znak"}]}], ",", 
             RowBox[{"start", "+", 
              RowBox[{"2", " ", 
               RowBox[{"vec", "/", "3"}]}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"start", "+", 
              RowBox[{"2", " ", 
               RowBox[{"vec", "/", "3"}]}]}], ",", "finish"}], "}"}], "]"}]}],
          "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Snowflake", "[", "3", "]"}]}]}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{{
     LineBox[NCache[{{0, 0}, {Rational[1, 27], 0}}, {{0, 0}, {
        0.037037037037037035`, 0}}]], 
     LineBox[NCache[{{Rational[1, 27], 0}, {0.05555555555555555, 
        0.02196026152894708}}, {{0.037037037037037035`, 0}, {
        0.05555555555555555, 0.02196026152894708}}]], 
     LineBox[NCache[{{0.05555555555555555, 0.02196026152894708}, {
        Rational[2, 27], 0}}, {{0.05555555555555555, 0.02196026152894708}, {
        0.07407407407407407, 0}}]], 
     LineBox[NCache[{{Rational[2, 27], 0}, {Rational[1, 9], 0}}, {{
        0.07407407407407407, 0}, {0.1111111111111111, 0}}]]}, {
     LineBox[NCache[{{Rational[1, 9], 0}, {0.12962962962962962`, 
        0.02196026152894708}}, {{0.1111111111111111, 0}, {
        0.12962962962962962`, 0.02196026152894708}}]], 
     LineBox[{{0.12962962962962962`, 0.02196026152894708}, {
      0.15190972222222224`, 0.021960261528947082`}}], 
     LineBox[{{0.15190972222222224`, 0.021960261528947082`}, {
      0.14814814814814814`, 0.04392052305789416}}], 
     LineBox[{{0.14814814814814814`, 0.04392052305789416}, {
      0.16666666666666666`, 0.06588078458684124}}]}, {
     LineBox[{{0.16666666666666666`, 0.06588078458684124}, {
      0.18518518518518517`, 0.043920523057894165`}}], 
     LineBox[{{0.18518518518518517`, 0.043920523057894165`}, {
      0.20746527777777776`, 0.04392052305789416}}], 
     LineBox[{{0.20746527777777776`, 0.04392052305789416}, {
      0.2037037037037037, 0.021960261528947082`}}], 
     LineBox[NCache[{{0.2037037037037037, 0.021960261528947082`}, {
        Rational[2, 9], 0}}, {{0.2037037037037037, 0.021960261528947082`}, {
        0.2222222222222222, 0}}]]}, {
     LineBox[NCache[{{Rational[2, 9], 0}, {Rational[7, 27], 0}}, {{
        0.2222222222222222, 0}, {0.25925925925925924`, 0}}]], 
     LineBox[NCache[{{Rational[7, 27], 0}, {
        0.2777777777777778, -0.02196026152894708}}, {{
        0.25925925925925924`, 0}, {
        0.2777777777777778, -0.02196026152894708}}]], 
     LineBox[NCache[{{0.2777777777777778, -0.02196026152894708}, {
        Rational[8, 27], 0}}, {{0.2777777777777778, -0.02196026152894708}, {
        0.2962962962962963, 0}}]], 
     LineBox[NCache[{{Rational[8, 27], 0}, {Rational[1, 3], 0}}, {{
        0.2962962962962963, 0}, {0.3333333333333333, 0}}]]}}, {{
     LineBox[NCache[{{Rational[1, 3], 0}, {
        0.35185185185185186`, -0.02196026152894708}}, {{
        0.3333333333333333, 0}, {
        0.35185185185185186`, -0.02196026152894708}}]], 
     LineBox[{{0.35185185185185186`, -0.02196026152894708}, {
      0.3741319444444444, -0.021960261528947075`}}], 
     LineBox[{{0.3741319444444444, -0.021960261528947075`}, {
      0.37037037037037035`, -0.04392052305789416}}], 
     LineBox[{{0.37037037037037035`, -0.04392052305789416}, {
      0.3888888888888889, -0.06588078458684124}}]}, {
     LineBox[{{0.3888888888888889, -0.06588078458684124}, {
      0.3851273148148148, -0.08784104611578832}}], 
     LineBox[{{0.3851273148148148, -0.08784104611578832}, {
      0.3702256944444445, -0.09659083781872817}}], 
     LineBox[{{0.3702256944444445, -0.09659083781872817}, {
      0.3813657407407407, -0.10980130764473539`}}], 
     LineBox[{{0.3813657407407407, -0.10980130764473539`}, {
      0.37760416666666663`, -0.13176156917368248`}}]}, {
     LineBox[{{0.37760416666666663`, -0.13176156917368248`}, {
      0.39988425925925924`, -0.13176156917368248`}}], 
     LineBox[{{0.39988425925925924`, -0.13176156917368248`}, {
      0.4110243055555555, -0.11855109934767524`}}], 
     LineBox[{{0.4110243055555555, -0.11855109934767524`}, {
      0.4221643518518518, -0.13176156917368248`}}], 
     LineBox[{{0.4221643518518518, -0.13176156917368248`}, {
      0.4444444444444444, -0.13176156917368248`}}]}, {
     LineBox[{{0.4444444444444444, -0.13176156917368248`}, {
      0.46296296296296297`, -0.15372183070262957`}}], 
     LineBox[{{0.46296296296296297`, -0.15372183070262957`}, {
      0.4592013888888889, -0.17568209223157663`}}], 
     LineBox[{{0.4592013888888889, -0.17568209223157663`}, {
      0.48148148148148145`, -0.17568209223157663`}}], 
     LineBox[{{0.48148148148148145`, -0.17568209223157663`}, {
      0.5, -0.19764235376052372`}}]}}, {{
     LineBox[{{0.5, -0.19764235376052372`}, {
      0.5185185185185185, -0.17568209223157663`}}], 
     LineBox[{{0.5185185185185185, -0.17568209223157663`}, {
      0.5147569444444444, -0.15372183070262954`}}], 
     LineBox[{{0.5147569444444444, -0.15372183070262954`}, {
      0.5370370370370371, -0.15372183070262957`}}], 
     LineBox[{{0.5370370370370371, -0.15372183070262957`}, {
      0.5555555555555556, -0.13176156917368248`}}]}, {
     LineBox[{{0.5555555555555556, -0.13176156917368248`}, {
      0.5517939814814815, -0.1098013076447354}}], 
     LineBox[{{0.5517939814814815, -0.1098013076447354}, {
      0.5629340277777778, -0.09659083781872815}}], 
     LineBox[{{0.5629340277777778, -0.09659083781872815}, {
      0.5480324074074073, -0.08784104611578833}}], 
     LineBox[{{0.5480324074074073, -0.08784104611578833}, {
      0.5442708333333333, -0.06588078458684124}}]}, {
     LineBox[{{0.5442708333333333, -0.06588078458684124}, {
      0.5665509259259258, -0.06588078458684124}}], 
     LineBox[{{0.5665509259259258, -0.06588078458684124}, {
      0.5776909722222221, -0.05267031476083401}}], 
     LineBox[{{0.5776909722222221, -0.05267031476083401}, {
      0.5888310185185185, -0.06588078458684124}}], 
     LineBox[{{0.5888310185185185, -0.06588078458684124}, {
      0.611111111111111, -0.06588078458684124}}]}, {
     LineBox[{{0.611111111111111, -0.06588078458684124}, {
      0.6296296296296295, -0.043920523057894165`}}], 
     LineBox[{{0.6296296296296295, -0.043920523057894165`}, {
      0.6519097222222222, -0.043920523057894165`}}], 
     LineBox[{{0.6519097222222222, -0.043920523057894165`}, {
      0.6481481481481481, -0.021960261528947082`}}], 
     LineBox[NCache[{{0.6481481481481481, -0.021960261528947082`}, {
        Rational[2, 3], 0}}, {{0.6481481481481481, -0.021960261528947082`}, {
        0.6666666666666666, 0}}]]}}, {{
     LineBox[NCache[{{Rational[2, 3], 0}, {Rational[19, 27], 0}}, {{
        0.6666666666666666, 0}, {0.7037037037037037, 0}}]], 
     LineBox[NCache[{{Rational[19, 27], 0}, {0.7222222222222222, 
        0.02196026152894708}}, {{0.7037037037037037, 0}, {0.7222222222222222, 
        0.02196026152894708}}]], 
     LineBox[NCache[{{0.7222222222222222, 0.02196026152894708}, {
        Rational[20, 27], 0}}, {{0.7222222222222222, 0.02196026152894708}, {
        0.7407407407407407, 0}}]], 
     LineBox[NCache[{{Rational[20, 27], 0}, {Rational[7, 9], 0}}, {{
        0.7407407407407407, 0}, {0.7777777777777778, 0}}]]}, {
     LineBox[NCache[{{Rational[7, 9], 0}, {
        0.7962962962962963, -0.02196026152894708}}, {{
        0.7777777777777778, 0}, {0.7962962962962963, -0.02196026152894708}}]],
      LineBox[{{0.7962962962962963, -0.02196026152894708}, {
      0.7925347222222222, -0.043920523057894165`}}], 
     LineBox[{{0.7925347222222222, -0.043920523057894165`}, {
      0.8148148148148149, -0.04392052305789416}}], 
     LineBox[{{0.8148148148148149, -0.04392052305789416}, {
      0.8333333333333334, -0.06588078458684124}}]}, {
     LineBox[{{0.8333333333333334, -0.06588078458684124}, {
      0.8518518518518519, -0.043920523057894165`}}], 
     LineBox[{{0.8518518518518519, -0.043920523057894165`}, {
      0.8480902777777778, -0.021960261528947096`}}], 
     LineBox[{{0.8480902777777778, -0.021960261528947096`}, {
      0.8703703703703703, -0.021960261528947082`}}], 
     LineBox[NCache[{{0.8703703703703703, -0.021960261528947082`}, {
        Rational[8, 9], 0}}, {{0.8703703703703703, -0.021960261528947082`}, {
        0.8888888888888888, 0}}]]}, {
     LineBox[NCache[{{Rational[8, 9], 0}, {Rational[25, 27], 0}}, {{
        0.8888888888888888, 0}, {0.9259259259259259, 0}}]], 
     LineBox[NCache[{{Rational[25, 27], 0}, {
        0.9444444444444444, -0.02196026152894708}}, {{
        0.9259259259259259, 0}, {0.9444444444444444, -0.02196026152894708}}]],
      LineBox[NCache[{{0.9444444444444444, -0.02196026152894708}, {
        Rational[26, 27], 0}}, {{0.9444444444444444, -0.02196026152894708}, {
        0.9629629629629629, 0}}]], 
     LineBox[NCache[{{Rational[26, 27], 0}, {1, 0}}, {{
        0.9629629629629629, 0}, {1, 0}}]]}}},
  AspectRatio->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.6891640364662356`*^9}]
}, Open  ]]
},
WindowSize->{707, 636},
WindowMargins->{{Automatic, 55}, {27, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5194, 133, 652, "Input"],
Cell[5777, 157, 8472, 148, 121, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

